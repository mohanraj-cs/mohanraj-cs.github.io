"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6449,1264],{66449:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var i=n(85893),r=n(10508).ZP.div.withConfig({componentId:"sc-1d70034d-0"})`
  &.drop {
    &::before {
      color: #f1f1f1;
      content: "Drop rom file here";
      display: flex;
      font-size: 16px;
      font-weight: 600;
      height: 100%;
      left: 0;
      place-content: center;
      place-items: center;
      position: absolute;
      top: 0;
      width: 100%;
    }
  }
`,a=n(1864),o=n(67294),s=n(92032),c=n(7459),l=n(26724),u=n(56758),d=n(64358),f=n(34254),m=n(91264),w=n(48764).Buffer,p=e=>{let{containerRef:t,id:n,loading:i,setLoading:r,url:p}=e;const{exists:S,mkdirRecursive:h,readFile:b,updateFolder:v,writeFile:E}=(0,l.o)(),{linkElement:g,processes:{[n]:{closing:y=!1}={}}={}}=(0,u.z)(),{prependFileToTitle:F}=(0,c.Z)(n),k=(0,o.useRef)(),T=(0,o.useRef)(""),$=(0,o.useCallback)((async()=>{if(!p)return;if(t.current?.classList.remove("drop"),T.current){if(T.current!==p&&(T.current="",window.EJS_terminate?.(),t.current)){const e=document.createElement("div");e.id="emulator",[...t.current.children].forEach((e=>e.remove())),t.current.append(e),$()}return}T.current=p,window.EJS_gameName=(0,a.basename)(p,(0,a.extname)(p));const[e,{core:n="",zip:i=!1}={}]=(o=(0,f.RT)(p),Object.entries(s.P).find((e=>{let[,{ext:t}]=e;return t.includes(o)}))||[]);var o;const c=await b(p);window.EJS_gameUrl=(0,f.YS)(i?w.from(await(0,m.zipAsync)({[(0,a.basename)(p)]:c})):c),window.EJS_core=n;const l=`${(0,a.basename)(p)}.sav`,u=(0,a.join)(d.Tl,l);window.EJS_onGameStart=e=>{let{detail:{emulator:t}}=e;(async()=>{await S(u)&&t.loadState?.(await b(u)),r(!1),k.current=t})()},window.EJS_onSaveState=e=>{let{screenshot:t,state:n}=e;window.EJS_terminate?.(),n&&(async()=>{if(await S(d.Tl)||await h(d.Tl),await E(u,w.from(n),!0)){const e=(0,a.join)(d.Xo,d.Tl),n=(0,a.join)(d.Xo,`${u}${d.Qy}`);await S(e)||(await h(e),v((0,a.dirname)(d.Tl))),await E(n,w.from(t),!0),v(d.Tl,l)}})()},window.EJS_player="#emulator",window.EJS_biosUrl="",window.EJS_pathtodata="Program Files/EmulatorJs/",window.EJS_startOnLoaded=!0,window.EJS_RESET_VARS=!0,window.EJS_Buttons={cacheManage:!1,loadState:!1,quickLoad:!1,quickSave:!1,saveState:!1,screenRecord:!1,screenshot:!1},await(0,f.mb)(["/Program Files/EmulatorJs/loader.js"],void 0,!0),F(`${window.EJS_gameName} (${e})`)}),[t,S,h,F,b,r,v,p,E]);(0,o.useEffect)((()=>{p?$():(r(!1),t.current?.classList.add("drop"))}),[t,$,r,p]),(0,o.useEffect)((()=>{if(!i){const e=t.current?.querySelector("canvas");e instanceof HTMLCanvasElement&&g(n,"peekElement",e)}return()=>{!i&&y&&k.current?.elements.buttons.saveState?.click()}}),[y,t,n,g,i])},S=n(2742),h=e=>{let{id:t}=e;return(0,i.jsx)(S.Z,{StyledComponent:r,id:t,useHook:p,children:(0,i.jsx)("div",{id:"emulator"})})}},2742:function(e,t,n){var i=n(85893),r=n(5152),a=n.n(r),o=n(67294),s=n(56758),c=n(55785);const l=a()((()=>n.e(6753).then(n.bind(n,26753))),{loadableGenerated:{webpack:()=>[26753]}});t.Z=(0,o.memo)((e=>{let{id:t,useHook:n,StyledComponent:r,children:a}=e;const{processes:{[t]:{url:u=""}={}}}=(0,s.z)(),d=(0,o.useRef)(null),[f,m]=(0,o.useState)(!0),w=(0,o.useMemo)((()=>({contain:"strict",visibility:f?"hidden":"visible"})),[f]);return n({containerRef:d,id:t,loading:f,setLoading:m,url:u}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(l,{}),(0,i.jsx)(r,{ref:d,style:w,...(0,c.Z)({id:t}),children:a})]})}))},55785:function(e,t,n){var i=n(1864),r=n(67294),a=n(62727),o=n(6529),s=n(42151),c=n(26724),l=n(56758),u=n(62065),d=n(64358),f=n(34254);t.Z=e=>{let{callback:t,directory:n=d.Ll,id:m,onDragLeave:w,onDragOver:p,updatePositions:S}=e;const{url:h}=(0,l.z)(),{iconPositions:b,sortOrders:v,setIconPositions:E}=(0,u.k)(),{mkdirRecursive:g,updateFolder:y,writeFile:F}=(0,c.o)(),k=(0,r.useCallback)((async(e,t,n)=>{if(m)if(t){const r=(0,i.join)(d.Ll,e);if(await g(d.Ll),await F(r,t,!0))return n===s.v.UPDATE_URL&&h(m,r),y(d.Ll,e),(0,i.basename)(r)}else n===s.v.UPDATE_URL&&h(m,e);return""}),[m,g,y,h,F]),{openTransferDialog:T}=(0,a.Z)();return{onDragLeave:w,onDragOver:e=>{p?.(e),(0,f.nK)(e)},onDrop:e=>{if(!d.my.has((0,f.RT)(n))){if(S&&e.target instanceof HTMLElement){const{files:t,text:r}=(0,o.p4)(e);if(0===t.length&&""===r)return;const a={x:e.clientX,y:e.clientY};let s=[];if(r){try{s=JSON.parse(r)}catch{}if(!Array.isArray(s))return;const[e]=s;if(!e)return;if(e.startsWith(n)&&(0,i.basename)(e)===(0,i.relative)(n,e))return;s=s.map((e=>(0,i.basename)(e)))}else s=t instanceof FileList?[...t].map((e=>e.name)):[...t].map((e=>e.getAsFile()?.name||"")).filter(Boolean);s=s.map((e=>{if(!b[`${n}/${e}`])return e;let t=0,r="";do{t+=1,r=`${n}/${(0,i.basename)(e,(0,i.extname)(e))} (${t})${(0,i.extname)(e)}`}while(b[r]);return(0,i.basename)(r)})),(0,f.vi)(n,e.target,b,v,a,s,E)}(0,o.WG)(e,t||k,n,T,Boolean(m))}}}}},7459:function(e,t,n){var i=n(67294),r=n(56758),a=n(25804),o=n(64358);t.Z=e=>{const{title:t}=(0,r.z)(),[n]=e.split(o.CC),{title:s}=a.Z[n]||{};return{appendFileToTitle:(0,i.useCallback)(((n,i)=>{const r=n?` - ${n}${i?` ${o.xy}`:""}`:"";t(e,`${s}${r}`)}),[e,s,t]),prependFileToTitle:(0,i.useCallback)(((n,i,r)=>{const a=n?`${i?`${o.xy} `:""}${n}${r?" ":" - "}`:"";t(e,`${a}${s}`)}),[e,s,t])}}},91264:function(e,t,n){n.d(t,{addEntryToZippable:function(){return c},addFileToZip:function(){return d},createZippable:function(){return s},isFileInZip:function(){return f},unarchive:function(){return m},unzip:function(){return l},zipAsync:function(){return u}});var i=n(1864),r=n(64358),a=n(34254),o=n(48764).Buffer;const s=(e,t)=>e.split("/").reduceRight(((e,t)=>({[t]:e})),[t,r.BF]),c=(e,t)=>{const[[n,i]]=Object.entries(t);return e[n]=n in e?c(e[n],t[n]):i,e},l=e=>new Promise(((t,i)=>{n.e(3778).then(n.bind(n,93778)).then((n=>{let{unzip:r}=n;return r(e,((e,n)=>e?i(e):t(n)))}))})),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BF;return new Promise(((i,r)=>{n.e(3778).then(n.bind(n,93778)).then((n=>{let{zip:a}=n;return a(e,t,((e,t)=>e?r(e):i(t)))}))}))},d=async(e,t,n,i)=>o.from(await u(c(e.length>0&&await l(e)||{},s(n,await i(t))))),f=(e,t)=>new Promise(((i,r)=>{n.e(3778).then(n.bind(n,93778)).then((n=>{let{unzip:a}=n;return a(e,((e,n)=>e?r(e):i(Object.keys(n).includes(t))))}))})),m=async(e,t)=>{if(window.SevenZip||await(0,a.mb)(["System/7zip/7zz.es6.js"]),!window.SevenZip)return{};const n=await window.SevenZip(),r=(0,i.basename)(e),s=(0,i.join)("/",(0,i.basename)(e,(0,i.extname)(e)));n.FS.mkdir(s),n.FS.chdir(s);const c=n.FS.open(r,"w+");n.FS.write(c,t,0,t.length),n.FS.close(c),n.callMain(["-y","x",r]);const l=n.FS.readdir(s),u=e=>(t,a)=>{if([".","..",r].includes(a))return t;const c=(0,i.join)(e,a),l=c.replace(s,"");try{n.FS.chmod(c,511)}catch{}return Object.assign(t,n.FS.isDir(n.FS.stat(c).mode)?{[(0,i.join)(l,"/")]:o.from(""),...n.FS.readdir(c).reduce(u(c),{})}:{[l]:n.FS.readFile(c,{flags:"r"})}),t};return l.reduce(u(s),{})}}}]);