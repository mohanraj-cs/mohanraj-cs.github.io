"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4338],{24338:function(e,t,i){i.r(t),i.d(t,{default:function(){return k}});var n=i(85893);var o=i(10508).ZP.div.withConfig({componentId:"sc-ff609c9c-0"})`
  canvas {
    background-color: #000;
    height: auto !important;
    width: auto !important;
  }

  div {
    font-family: "Liberation Mono", "DejaVu Sans Mono", "Courier New", monospace;
    font-size: 14px;
    font-weight: 700;
    line-height: normal;
    position: relative;
    white-space: pre;
  }
`,r=i(1864),a=i(67294);const s={autostart:!0,bios:{url:"/Program Files/Virtual x86/bios/seabios.bin"},log_level:0,network_relay_url:"wss://relay.widgetry.org/",vga_bios:{url:"/Program Files/Virtual x86/bios/vgabios.bin"},wasm_path:"/Program Files/Virtual x86/v86.wasm"},l=new Set([160,180,200,320,360,400,720,1200,1440,1722,2880]),c=(e,t)=>".bin"===e?"bzimage":(e=>l.has(e>>10)&&0===(1023&e)||512===e)(t)?"fda":"hda";var u=i(23615);const h="screen-set-size-graphical",d="screen-set-size-text";var f=(e,t,i)=>{const{updateWindowSize:n}=(0,u.Z)(e);(0,a.useEffect)((()=>{const e=e=>{let[t,i]=e;return n(i,t)},o=e=>{let[,i]=e;const{height:o,width:r}=t.current?.querySelector("span:last-of-type")?.getBoundingClientRect()||{};o&&r&&n(i*o,r)};return i?.add_listener(h,e),i?.add_listener(d,o),()=>{i?.remove_listener(h,e),i?.remove_listener(d,o)}}),[i,t,n])},p=i(7459),m=i(26724),g=i(33631),w=i(56758),b=i(62065),x=i(64358),v=i(34254),y=i(48764).Buffer;window.DEBUG=!1;var T=e=>{let{containerRef:t,id:i,loading:n,setLoading:o,url:l}=e;const{processes:{[i]:u}}=(0,w.z)(),{foregroundId:h}=(0,b.k)(),{closing:d,libs:T=[]}=u||{},{appendFileToTitle:_}=(0,p.Z)(i),k=(0,a.useRef)(!1),[z,C]=(0,a.useState)({}),{exists:$,mkdirRecursive:L,readFile:R,updateFolder:S,writeFile:E}=(0,m.o)(),M=(0,a.useCallback)((e=>new Promise(((t,i)=>{z[e]?.save_state().then(t).catch(i)}))),[z]),F=(0,a.useCallback)((async(e,t)=>{const i=`${(0,r.basename)(e)}.bin.save`;await $(x.Tl)||(await L(x.Tl),S((0,r.dirname)(x.Tl)));const n=(0,r.join)(x.Tl,i);if(await E(n,y.from(await M(e)),!0)){if(t){const e=(0,r.join)(x.Xo,x.Tl),i=(0,r.join)(x.Xo,`${n}${x.Qy}`);await $(e)||(await L(e),S((0,r.dirname)(x.Tl))),await E(i,t,!0)}try{z[e]?.destroy()}catch{}finally{S(x.Tl,i)}}}),[z,$,L,M,S,E]),j=(0,a.useCallback)((async()=>{const[e]=Object.keys(z);e&&await F(e);const i=l?await R(l):y.from(""),n=(0,v.RT)(l),o=".iso"===n,a=(0,v.YS)(i),u={[o?"cdrom":c(n,i.length)]:{async:!1,size:i.length,url:a,use_parts:!1}},{deviceMemory:h=.25}=navigator,d={boot_order:o?531:561,memory_size:128*h*1024*1024,screen_container:t.current,vga_memory_size:8*h*1024*1024,...u,...s},f=(0,r.join)(x.Tl,`${(0,r.basename)(l)}.bin.save`),p=await $(f)?(0,v.YS)(await R(f)):void 0;p&&(d.initial_state={url:p}),d.filesystem={basefs:URL.createObjectURL(new Blob([JSON.stringify((0,g.uh)())],{type:"application/json"})),baseurl:window.location?.origin??"/"};const m=new window.V86Starter(d);m.add_listener("emulator-loaded",(()=>{k.current?m.destroy():(_((0,r.basename)(l)),(0,v.EK)(a),d.initial_state&&(0,v.EK)(d.initial_state.url),d.filesystem&&(0,v.EK)(d.filesystem.basefs),t.current?.addEventListener("click",m.lock_mouse),C({[l]:m}))}))}),[_,F,t,z,$,R,l]);f(i,t,z[l]),(0,a.useEffect)((()=>{n&&(0,v.mb)(T).then((()=>{window.V86Starter&&o(!1)}))}),[T,n,o]),(0,a.useEffect)((()=>{const e=h===i;Object.values(z).forEach((t=>t?.keyboard_set_status(e)))}),[z,h,i]),(0,a.useEffect)((()=>{!u||d||n||l in z||(C({[l]:void 0}),j());const e=t.current;return()=>{if(l&&d&&!k.current&&(k.current=!0,z[l])){const t=e=>{window.setTimeout((()=>F(l,e)),x.jx.WINDOW)};(async()=>{let t;if(z[l]?.v86.cpu.devices.vga.graphical_mode)t=e?.querySelector("canvas")?.toDataURL("image/png");else if(e instanceof HTMLElement){const i=await(0,v.mZ)();try{t=await(i?.toPng(e,{skipAutoScale:!0}))}catch{}}return t?y.from(t.replace("data:image/png;base64,",""),"base64"):void 0})().then(t).catch(t)}}}),[F,d,t,z,j,n,u,l])},_=i(2742);var k=e=>{let{id:t}=e;return(0,n.jsxs)(_.Z,{StyledComponent:o,id:t,useHook:T,children:[(0,n.jsx)("div",{onContextMenuCapture:v.nK}),(0,n.jsx)("canvas",{onContextMenuCapture:v.nK})]})}},2742:function(e,t,i){var n=i(85893),o=i(5152),r=i.n(o),a=i(67294),s=i(56758),l=i(55785);const c=r()((()=>i.e(6753).then(i.bind(i,26753))),{loadableGenerated:{webpack:()=>[26753]}}),u=e=>{let{id:t,useHook:i,StyledComponent:o,children:r}=e;const{processes:{[t]:{url:u=""}={}}}=(0,s.z)(),h=(0,a.useRef)(null),[d,f]=(0,a.useState)(!0),p=(0,a.useMemo)((()=>({contain:"strict",visibility:d?"hidden":"visible"})),[d]);return i({containerRef:h,id:t,loading:d,setLoading:f,url:u}),(0,n.jsxs)(n.Fragment,{children:[d&&(0,n.jsx)(c,{}),(0,n.jsx)(o,{ref:h,style:p,...(0,l.Z)({id:t}),children:r})]})};t.Z=(0,a.memo)(u)},55785:function(e,t,i){var n=i(1864),o=i(67294),r=i(62727),a=i(6529),s=i(42151),l=i(26724),c=i(56758),u=i(62065),h=i(64358),d=i(34254);t.Z=e=>{let{callback:t,directory:i=h.Ll,id:f,onDragLeave:p,onDragOver:m,updatePositions:g}=e;const{url:w}=(0,c.z)(),{iconPositions:b,sortOrders:x,setIconPositions:v}=(0,u.k)(),{mkdirRecursive:y,updateFolder:T,writeFile:_}=(0,l.o)(),k=(0,o.useCallback)((async(e,t,i)=>{if(f)if(t){const o=(0,n.join)(h.Ll,e);if(await y(h.Ll),await _(o,t,!0))return i===s.v.UPDATE_URL&&w(f,o),T(h.Ll,e),(0,n.basename)(o)}else i===s.v.UPDATE_URL&&w(f,e);return""}),[f,y,T,w,_]),{openTransferDialog:z}=(0,r.Z)();return{onDragLeave:p,onDragOver:e=>{m?.(e),(0,d.nK)(e)},onDrop:e=>{if(!h.my.has((0,d.RT)(i))){if(g&&e.target instanceof HTMLElement){const{files:t,text:o}=(0,a.p4)(e);if(0===t.length&&""===o)return;const r={x:e.clientX,y:e.clientY};let s=[];if(o){try{s=JSON.parse(o)}catch{}if(!Array.isArray(s))return;const[e]=s;if(!e)return;if(e.startsWith(i)&&(0,n.basename)(e)===(0,n.relative)(i,e))return;s=s.map((e=>(0,n.basename)(e)))}else s=t instanceof FileList?[...t].map((e=>e.name)):[...t].map((e=>e.getAsFile()?.name||"")).filter(Boolean);s=s.map((e=>{if(!b[`${i}/${e}`])return e;let t=0,o="";do{t+=1,o=`${i}/${(0,n.basename)(e,(0,n.extname)(e))} (${t})${(0,n.extname)(e)}`}while(b[o]);return(0,n.basename)(o)})),(0,d.vi)(i,e.target,b,x,r,s,v)}(0,a.WG)(e,t||k,i,z,Boolean(f))}}}}},99895:function(e,t,i){i.d(t,{BS:function(){return a},FC:function(){return o},F_:function(){return n},wV:function(){return r}});const n={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},o={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},r=30,a=166,s={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${r}px`,minWidth:`${a}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};t.ZP=s},4914:function(e,t,i){i.d(t,{Rf:function(){return s},b$:function(){return u},hu:function(){return a},ix:function(){return c},mZ:function(){return l}});var n=i(99895),o=i(64358),r=i(34254);const a=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const[a]=e.split(o.CC),s=`${a}${o.CC}`,l=i.find((e=>e.startsWith(s)))||"",{componentWindow:c}=t?.[l]||{},{x:u=0,y:h=0,width:d=0,height:f=0}=c?.getBoundingClientRect()||{},p=u+n+d>(0,r.E9)()||h+n+f>(0,r.sI)();return p||!u&&!h?void 0:{x:u+n,y:h+n}},s=e=>{let{height:t,width:i}=e;const[n,a]=[(0,r.sI)(),(0,r.E9)()];return{x:Math.floor(a/2-(0,r.Vy)(i)/2),y:Math.floor((n-o.bK)/2-(0,r.Vy)(t)/2)}},l={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},c=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{position:n,size:o}=e||{},{x:a=0,y:s=0}=n||{},{height:c=0,width:u=0}=o||{};return i?a+l.RIGHT>t.x||a+(0,r.Vy)(u)-l.LEFT<0||s+l.BOTTOM>t.y||s+l.TOP<0:a<0||s<0||a+(0,r.Vy)(u)>t.x||s+(0,r.Vy)(c)>t.y},u=(e,t)=>{const i=Number(e.height),a=Number(e.width),[s,l]=[(0,r.sI)(),(0,r.E9)()],c=s-o.bK,u=Math.max(n.wV,Math.min(i,c)),h=Math.max(n.BS,Math.min(a,l));if(!t)return{height:u,width:h};const d=i===u,f=a===h;return d||f?d?f?{height:u,width:h}:{height:Math.round(u/(a/h)),width:h}:{height:u,width:Math.round(h/(i/u))}:i>a?{height:u,width:Math.round(h/(c/u))}:{height:Math.round(u/(l/h)),width:h}}},7459:function(e,t,i){var n=i(67294),o=i(56758),r=i(25804),a=i(64358);t.Z=e=>{const{title:t}=(0,o.z)(),[i]=e.split(a.CC),{title:s}=r.Z[i]||{};return{appendFileToTitle:(0,n.useCallback)(((i,n)=>{const o=i?` - ${i}${n?` ${a.xy}`:""}`:"";t(e,`${s}${o}`)}),[e,s,t]),prependFileToTitle:(0,n.useCallback)(((i,n,o)=>{const r=i?`${n?`${a.xy} `:""}${i}${o?" ":" - "}`:"";t(e,`${r}${s}`)}),[e,s,t])}}},23615:function(e,t,i){var n=i(67294),o=i(10508),r=i(4914),a=i(56758),s=i(62065);t.Z=e=>{const{setWindowStates:t}=(0,s.k)(),{processes:{[e]:{lockAspectRatio:i=!1,maximized:l=!1}={}}={}}=(0,a.z)(),{sizes:{titleBar:c}}=(0,o.Fg)();return{updateWindowSize:(0,n.useCallback)(((n,o)=>t((t=>({...t,[e]:{...t?.[e],maximized:l,size:(0,r.b$)({height:n+c.height,width:o},i)}})))),[e,i,l,t,c.height])}}}}]);